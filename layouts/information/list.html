{{- define "main" }}
    {{- if .Content }}
    <section class="card card--hero">
        <div class="card__content card__content--hero">
            {{ .Content }}
        </div>
    </section>
    {{- end }}
    {{ $sorted := slice }}
    {{ range .Pages }}
        {{ $weight := .Params.weight | default 999 }}
        {{ $sorted = $sorted | append (dict "page" . "weight" $weight "title" .Title) }}
    {{ end }}
    {{ $sorted = sort (sort $sorted "title") "weight" }}
    {{ $pages := slice }}
    {{ range $sorted }}
        {{ $pages = $pages | append .page }}
    {{ end }}
    {{ $paginator := .Paginate $pages }}
    {{ range $paginator.Pages }}
        <article class="card{{ if not .Params.feature }} card--coverless{{ end }}">
            {{- if .Params.feature }}
                {{- $alt := .Params.featureAlt | default .Params.featureCaption | default "A Decorative Image" }}
                {{- $feature := .Params.feature }}
                <figure class="card__cover">
                    <a href="{{ .RelPermalink }}">
                    {{- with .Resources.GetMatch .Params.feature }}
                        {{- partial "function/responsive-image" (dict "image" . "alt" $alt "widths" (slice 400 600 900 1200)) }}
                    {{- else }}
                        <img src="{{ $feature }}" alt="{{ $alt }}">
                    {{- end }}
                    </a>
                </figure>
            {{- end }}
            <div class="card__content">
                <div class="card__header">
                    <h2 class="card__title"><a href="{{ .RelPermalink }}">{{ .Title }}</a></h2>
                    {{ with .Params.subtitle }} <span class="card__subtitle">{{ . }}</span>{{ end }}
                </div>
                <div class="card__description">{{ .Params.description | default (.Summary | truncate 200 "...") }}</div>
            </div>
        </article>
    {{- end }}
{{- end }}

{{- define "pagination" }}
    {{ partial "site/pagination" . }}
{{- end }}
