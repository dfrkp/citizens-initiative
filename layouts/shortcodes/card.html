{{- $title := .Get "title" }}
{{- $link := .Get "link" }}
{{- $linkText := .Get "linkText" | default (i18n "learn_more") }}
{{- $icon := .Get "icon" }}
{{- $imagePath := .Get "image" }}
{{- $imageAlt := .Get "imageAlt" | default $title }}
{{- $class := .Get "class" | default "" }}

<article class="card card--static {{ $class }}">
    {{- with $imagePath }}
    <figure class="card__cover">
        {{- $processed := false }}
        {{- $imageResource := false }}
        {{- /* Try page resources first */ -}}
        {{- with $.Page.Resources.GetMatch . }}
            {{- $imageResource = . }}
            {{- $processed = true }}
        {{- end }}
        {{- /* Try global resources (assets) - strip leading slash */ -}}
        {{- if not $processed }}
            {{- $assetPath := strings.TrimPrefix "/" $imagePath }}
            {{- with resources.Get $assetPath }}
                {{- $imageResource = . }}
                {{- $processed = true }}
            {{- end }}
        {{- end }}
        {{- if $processed }}
            {{- partial "function/responsive-image" (dict "image" $imageResource "alt" $imageAlt "widths" (slice 400 600 900)) }}
        {{- else }}
            <img src="{{ . }}" alt="{{ $imageAlt }}">
        {{- end }}
    </figure>
    {{- end }}
    <div class="card__content card__content--static">
        {{- with $icon }}
        <div class="card__icon">{{ . | safeHTML }}</div>
        {{- end }}
        {{- with $title }}
        <h3 class="card__title">
            {{- with $link }}<a href="{{ . }}">{{ end }}
            {{- . }}
            {{- with $link }}</a>{{ end }}
        </h3>
        {{- end }}
        <div class="card__description">
            {{ $.Inner | markdownify }}
        </div>
        {{- with $link }}
        <span class="card__link">{{ $linkText }} &rarr;</span>
        {{- end }}
    </div>
</article>
